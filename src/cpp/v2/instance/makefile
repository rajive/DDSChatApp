######################################################################
# makefile
#
# This makefile assumes that the build environment is already correctly
# configured. (For example, the correct version of your compiler and
# linker should be on the PATH.)
######################################################################

# Include autogenerated makefile (if any) to build for the desired target
include $(wildcard makefile_Chat_*)

# If undefined in the environment default NDDSHOME to install dir
ifndef NDDSHOME
NDDSHOME := "/opt/rti/NDDSHOME"
endif

ifndef TYPES_DIR
TYPES_DIR=../../../../res/types/v2
endif

CODEGEN_OPTIONS=-language C++ -unboundedSupport -namespace -useStdString

# Generate C++ type handling code from IDL datatypes:
ChatSupport.cxx ChatPlugin.cxx Chat.cxx \
ChatSupport.h ChatPlugin.h Chat.h : \
$(TYPES_DIR)/Chat.idl
	$(NDDSHOME)/bin/rtiddsgen $(CODEGEN_OPTIONS) \
			-update typefiles -d . $?

# Generate makefiles or Visual Studio solutions, e.g.:
# 		 make makefile/x64Darwin17clang9.0
makefile/%:
	-rm makefile_Chat_*
	$(NDDSHOME)/bin/rtiddsgen $(CODEGEN_OPTIONS) \
			-update makefiles -platform $* -d . $(TYPES_DIR)/Chat.idl

# Clean generated files 
clean:
	-rm -rf objs/
	-rm Chat.h Chat.cxx \
	    ChatPlugin.h ChatPlugin.cxx \
	    ChatSupport.h ChatSupport.cxx
